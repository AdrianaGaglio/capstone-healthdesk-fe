<div class="container-fluid">
  <div class="row">
    <h3 class="mb-3 display-4">Impostazioni profilo</h3>
    <div class="col col-12 px-3 mb-3">
      <div class="mb-3 card p-2 rounded-1 border-0 shadow-sm default-bg">
        <div
          class="d-flex justify-content-between align-items-center mb-3 border-bottom border-secondary pb-2"
        >
          <h5 class="fw-bolder mb-0">Dati personali</h5>
          <div class="d-flex gap-2">
            <app-btn-primary-filled
              *ngIf="edit"
              [type]="'button'"
              [title]="'Conferma modifiche'"
              (onClick)="update(doctor.id, doctor)"
              >Conferma</app-btn-primary-filled
            >
            <app-btn-dark-filled
              [type]="'button'"
              (onClick)="edit = !edit"
              [title]="edit ? 'Annulla modifica' : 'Modifica dati personali'"
              >{{ edit ? "Annulla" : "Modifica" }}</app-btn-dark-filled
            >
          </div>
        </div>
        <div class="d-flex gap-3 align-items-start">
          <div class="position-relative text-center">
            <img
              [src]="getAvatar()"
              alt="immagine profilo"
              class="rounded-2 w-fixed-150 object-fit-cover object-position-center"
            />
            <input
              type="file"
              accept="image/*"
              (change)="onFileSelected($event)"
              #fileInput
              hidden
            />
            <app-btn-primary-filled
              class="position-absolute end-0 bottom-0 me-1 mb-1"
              [class]="'position-relative w-fixed-30 h-fixed-30'"
              [type]="'button'"
              (onClick)="fileInput.click()"
            >
              <ng-icon
                class="position-absolute start-50 top-50 translate-middle"
                name="ionCloudUploadOutline"
              ></ng-icon>
            </app-btn-primary-filled>
          </div>
          <div *ngIf="doctor">
            <h6 class="fs-3 fw-medium" *ngIf="!edit">
              {{ doctor.name }} {{ doctor.surname }}
            </h6>
            <div *ngIf="edit" class="d-flex gap-2 align-items-center">
              <div>
                <label for="name" class="form-label fs-sm mb-1">Nome</label>
                <input
                  type="text"
                  name="name"
                  id="name"
                  [(ngModel)]="doctor.name"
                  class="form-control form-control-sm border-secondary shadow-sm w-auto mb-2"
                />
              </div>
              <div>
                <label for="surname" class="form-label fs-sm mb-1"
                  >Cognome</label
                >
                <input
                  type="text"
                  name="surname"
                  id="surname"
                  [(ngModel)]="doctor.surname"
                  class="form-control form-control-sm border-secondary shadow-sm w-auto mb-2"
                />
              </div>
            </div>

            <p class="mb-2 d-flex align-items-center gap-2">
              Titolo:
              <span *ngIf="!edit" class="fw-medium">{{
                doctor.title ? doctor.title : "-----"
              }}</span>
              <input
                *ngIf="edit"
                type="text"
                name="title"
                id="title"
                [(ngModel)]="doctor.title"
                class="form-control form-control-sm border-secondary shadow-sm w-auto mb-0"
              />
            </p>
            <p class="mb-2 d-flex align-items-center gap-2">
              Licenza:
              <span *ngIf="!edit" class="fw-medium">{{
                doctor.licenceNumber
              }}</span>
              <input
                type="text"
                name="licenceNumber"
                [(ngModel)]="doctor.licenceNumber"
                *ngIf="edit"
                class="form-control form-control-sm border-secondary shadow-sm w-auto mb-0"
              />
            </p>
            <p class="mb-2 d-flex align-items-center gap-2">
              Telefono:
              <span *ngIf="!edit" class="fw-medium">{{
                doctor.phoneNumber
              }}</span>
              <input
                type="text"
                name="phoneNumber"
                [(ngModel)]="doctor.phoneNumber"
                *ngIf="edit"
                class="form-control form-control-sm border-secondary shadow-sm w-auto mb-0"
              />
            </p>
          </div>
        </div>
      </div>
      <div class="mb-3 card p-2 rounded-1 border-0 shadow-sm default-bg">
        <app-edit-login-info
          [user]="doctor"
          (onUpdate)="feedback('Dati di accesso modificati')"
        ></app-edit-login-info>
      </div>
      <div class="mb-3 card p-2 rounded-1 border-0 shadow-sm default-bg">
        <app-specializations [doctor]="doctor"></app-specializations>
      </div>
      <div class="mb-3 card p-2 rounded-1 border-0 shadow-sm default-bg">
        <app-trainings [doctor]="doctor"></app-trainings>
      </div>
      <div class="mb-3 card p-2 rounded-1 border-0 shadow-sm default-bg">
        <app-experiences [doctor]="doctor"></app-experiences>
      </div>
    </div>
  </div>
</div>
