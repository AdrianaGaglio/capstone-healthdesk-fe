<div class="border-bottom border-1 pb-3 mb-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5 class="mb-0 fw-bold text-dark">{{ title }}</h5>
    <app-btn-secondary-filled
      *ngIf="isDoctor || isPatient"
      [type]="'button'"
      [extraClass]="'position-relative w-fixed-30 h-fixed-30'"
      (onClick)="add = !add"
    >
      <ng-icon
        class="fs-4 position-absolute start-50 top-50 translate-middle"
        [name]="!add ? 'ionAddOutline' : 'ionRemoveOutline'"
      ></ng-icon>
    </app-btn-secondary-filled>

    <div
      *ngIf="(isDoctor || isPatient) && add"
      class="position-absolute top-50 w-75 start-50 translate-middle z-3"
    >
      <form #form="ngForm" class="position-relative">
        <ng-icon
          role="button"
          name="ionCloseOutline"
          class="position-absolute top-0 end-0 z-3 me-3 mt-3"
          (click)="add = !add"
        ></ng-icon>
        <div
          role="button"
          cdkDropList
          class="upload-area rounded-3 shadow-lg default-bg d-flex flex-column align-items-center justify-content-center text-center position-relative"
          (drop)="onDrop($event)"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          [class.dragging]="isDragging"
        >
          <p *ngIf="!files.length" class="fs-sm text-dark">
            Trascina qui il tuo file PDF o clicca per selezionarlo
          </p>
          <ul *ngIf="files.length">
            <li *ngFor="let file of files">{{ file.name }}</li>
          </ul>
          <input
            type="file"
            accept=".pdf"
            (change)="onFileSelected($event)"
            #fileInput
            hidden
          />

          <app-btn-secondary-filled
            [type]="'button'"
            (onClick)="fileInput.click()"
            >Seleziona un file</app-btn-secondary-filled
          >
          <div
            class="d-flex align-items-end gap-2 position-absolute start-0 end-0 bottom-0 ms-2 me-2 mb-2"
          >
            <div class="flex-grow-1 text-start">
              <span class="text-danger fs-sm" *ngIf="showError"
                >Campo obbligatorio</span
              >
              <input
                type="text"
                placeholder="Breve descrizione"
                class="form-control form-control-sm"
                required
                name="description"
                id="description"
                [(ngModel)]="description"
              />
            </div>
            <app-btn-dark-filled [type]="'button'" (onClick)="upload()"
              >Carica</app-btn-dark-filled
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <ng-container *ngIf="!documentations || documentations.length < 1"
    >Nessun documento</ng-container
  >
  <ng-container *ngIf="documentations && documentations.length > 0">
    <app-prescription-card
      [documentation]="d"
      [mfID]="mfID"
      [isDoctor]="isDoctor"
      [isPatient]="isPatient"
      (onDelete)="updateList($event)"
      *ngFor="let d of documentations"
    >
    </app-prescription-card>
  </ng-container>
</div>
